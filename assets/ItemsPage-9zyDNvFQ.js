import{u as P,a as M,r as g,j as e,L as w,S as T}from"./main-jdxjInvn.js";import{E as C,I as E,a as $}from"./ErrorMessage-LCsYCziH.js";/* empty css                */const b=x=>{const{loading:i,error:d,getAllItems:n,getCategoryItems:f}=P(),{setItems:u,filteredItems:l,setPagesCount:c,favorites:h,setFavorites:m,cart:s,setCart:p}=x,o=M().id,[r,a]=g.useState(!1),[j,N]=g.useState({}),[y,S]=g.useState(0);g.useEffect(()=>{if(!o)n().then(t=>{u(t),c(t.length?Math.ceil(t.length/16):0),a(!1)});else if(parseInt(o)>0)f(parseInt(o)).then(t=>{u(t),c(t.length?Math.ceil(t.length/16):0),a(!1)});else if(o==="favourites")u(h),c(h.length?Math.ceil(h.length/16):0),a(!1);else if(o==="cart"){u(s),c(s.length?Math.ceil(s.length/16):0),a(!0);const t={};s.forEach(_=>{t[_.id]=parseInt(localStorage.getItem(`${_.id}-count`)||"1")}),N(t),I()}else u(void 0),c(0),a(!1)},[o]),g.useEffect(()=>{r&&I()},[j]);const I=()=>{let t=0;s.forEach(_=>{t+=_.price*j[_.id]}),S(t)},A=i||d||!l?e.jsx(C,{text:"There ain't any items yet. We hope it'll change soon!"}):l!=null&&l.length?l.map(t=>e.jsxs("li",{className:`items__item ${r?"items__item--cart":""}`,children:[e.jsx("div",{className:"items__item-image",children:e.jsx(w,{to:`/item/${t.id}`,children:e.jsx("img",{src:t.images[0],className:"items__item-image",alt:"Item image."})})}),e.jsxs("div",{className:"items__item-info",children:[r?e.jsxs("p",{className:"items__item-description",children:["Category: ",t.category.name]}):e.jsx(e.Fragment,{}),e.jsx(w,{to:`/item/${t.id}`,className:"items__item-title",children:e.jsx("h2",{children:t.title})}),e.jsxs("p",{className:"items__item-price",children:["$",r?t.price*j[t.id]:t.price]})]}),e.jsxs("div",{className:"items__item-buttons",children:[e.jsx(E,{storageKey:"favourites",id:t.id,item:t,itemsArray:h,setItemsArray:m}),e.jsx(E,{storageKey:"cart",id:t.id,item:t,itemsArray:s,setItemsArray:p,cartCounts:j,setCartCounts:N})]})]},t.id)):(l==null?void 0:l.length)===0?e.jsx(C,{text:"Oops! Nothing was founded. Check your request for typos"}):e.jsx(C,{text:"There ain't any items yet. We hope it'll change soon!"}),F=i?e.jsx(T,{}):null,L=d?e.jsx($,{}):null;return e.jsxs(e.Fragment,{children:[r?e.jsx("p",{className:"cart__total",children:`Total: ${isNaN(y)?0:y}`}):e.jsx(e.Fragment,{children:" "}),e.jsxs("ul",{className:`items__list ${r?"items__list--cart":""}`,children:[A,F,L]})]})},v=16,z=x=>{const{items:i,setFilteredItems:d,filter:n,setFilter:f,activePage:u,setPagesCount:l}=x,c=v*(u-1),h=()=>{if(i!=null&&i.length){let s=i;n.search&&(s=i.filter(p=>p.title.toLowerCase().includes(n.search.toLowerCase()))),s=m(s,n.sort),l(Math.ceil(s.length/v)),d(s.slice(c,c+v))}else d(void 0)};g.useEffect(()=>{h()},[i,n,u]);const m=(s,p)=>{const o=[...s];switch(p){case"nameaz":return o.sort((r,a)=>r.title.toLowerCase()<a.title.toLowerCase()?-1:r.title.toLowerCase()>a.title.toLowerCase()?1:0);case"nameza":return o.sort((r,a)=>r.title.toLowerCase()>a.title.toLowerCase()?-1:r.title.toLowerCase()<a.title.toLowerCase()?1:0);case"pricelow":return o.sort((r,a)=>r.price<a.price?-1:r.price>a.price?1:0);case"pricehigh":return o.sort((r,a)=>r.price>a.price?-1:r.price<a.price?1:0);default:return s}};return e.jsxs("div",{className:"items__filters",children:[e.jsx("div",{className:"items__filters-search",children:e.jsx("input",{type:"text",name:"search",id:"search",className:"items__filters-input",placeholder:"Search a product",autoComplete:"off",value:n.search,onChange:s=>f({...n,search:s.target.value})})}),e.jsx("div",{className:"items__filters-sort",children:e.jsxs("label",{className:"items__filters-label",children:[e.jsx("span",{children:"Sort by:"}),e.jsxs("select",{name:"sort",id:"sort",className:"items__filters-select",onChange:s=>f({...n,sort:s.target.value}),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"nameaz",children:"Name A-Z"}),e.jsx("option",{value:"nameza",children:"Name Z-A"}),e.jsx("option",{value:"pricelow",children:"Price low to high"}),e.jsx("option",{value:"pricehigh",children:"Price high to low"})]})]})})]})},k=x=>{const{smoothScrollToTop:i}=P(),{pagesCount:d,activePage:n,setActivePage:f,filter:u,setFilter:l}=x;g.useEffect(()=>{c()},[d,n]);const c=()=>{if(d){const h=[];for(let m=1;m<=d;m++)h.push(e.jsx("li",{className:"items__pagination-item",children:e.jsx("button",{disabled:n===m,className:"items__pagination-button",onClick:()=>{f(m),l({...u}),i(500)},children:m})},m));return h}return[]};return e.jsx("div",{className:"items__pagination",children:e.jsx("ul",{className:"items__pagination-list",children:c()})})},R=x=>{const{activePage:i,setActivePage:d,favorites:n,setFavorites:f,cart:u,setCart:l}=x,[c,h]=g.useState(void 0),[m,s]=g.useState(void 0),[p,o]=g.useState({search:"",sort:"default"}),[r,a]=g.useState(0);return e.jsx("div",{className:"items",children:e.jsxs("div",{className:"items__content",children:[e.jsx("h1",{className:"visually-hidden",children:"Main page"}),e.jsx(z,{items:c,setItems:h,filteredItems:m,setFilteredItems:s,filter:p,setFilter:o,activePage:i,setPagesCount:a}),e.jsx(b,{setItems:h,filteredItems:m,setPagesCount:a,favorites:n,setFavorites:f,cart:u,setCart:l}),e.jsx(k,{pagesCount:r,activePage:i,setActivePage:d,filter:p,setFilter:o})]})})};export{R as default};
